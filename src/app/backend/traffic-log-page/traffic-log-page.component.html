<div class="dashboard-container">
    <!-- 左側導航 -->
    <div class="sidebar">
        <a href="trafficLogPage">
            <h2>管理後台</h2>
        </a>
        <a href="trafficLogPage#card-visitors">
            <div class="nav-link" [class.active]="activeSection === 'visitors'" (click)="showSection('visitors')">
                👥 訪客統計
            </div>
        </a>
        <a href="trafficLogPage#card-traffic">
            <div class="nav-link" [class.active]="activeSection === 'traffic'" (click)="showSection('traffic')">
                📈 流量紀錄
            </div>
        </a>
        <a href="trafficLogPage#card-faq">
            <div class="nav-link" [class.active]="activeSection === 'faq'" (click)="showSection('faq')">
                📂 FAQ 分類
            </div>
        </a>
        <a href="trafficLogPage#card-success">
            <div class="nav-link" [class.active]="activeSection === 'success'" (click)="showSection('success')">
                🕛遇時次數
            </div>
        </a>
        <a href="trafficLogPage#card-unknown">
            <div class="nav-link" [class.active]="activeSection === 'unknown'" (click)="showSection('unknown')">
                ❓ 未知問題
            </div>
        </a>
    </div>

    <!-- 右側內容 -->
    <div class="main">
        <div class="dashboard-header">
            <span>📊 儀表板總覽</span>
            <div class="user-info">管理員：{{ adminName }} | {{ currentDate }}</div>
        </div>

        <!-- 統計概覽 -->
        <div class="stats-row">
            <div class="stat-card" *ngFor="let card of statsCards">
                <div class="stat-number">{{ card.number }}</div>
                <div class="stat-label">{{ card.label }}</div>
            </div>
        </div>

        <!-- 訪客統計 -->
        <div class="card" id="card-visitors">
            <h3>👥 訪客使用統計</h3>
            <div class="chart-placeholder">長條圖 - 用戶身份分析</div>
            <div class="grid-two-col">
                <div class="grid-box">
                    <div class="grid-number">67%</div>
                    <div class="grid-label">登入用戶</div>
                </div>
                <div class="grid-box">
                    <div class="grid-number">33%</div>
                    <div class="grid-label">訪客用戶</div>
                </div>
            </div>
        </div>

        <!-- 流量紀錄區塊 -->
        <div class="card-grid">
            <!-- 流量紀錄 -->
            <div class="card" id="card-traffic">
                <h3>📈 流量紀錄</h3>
                <div class="tabs">
                    <button class="tab" [class.active]="activeTab === 'daily'" (click)="showTab('daily')">
                        每日使用
                    </button>
                    <button class="tab" [class.active]="activeTab === 'hourly'" (click)="showTab('hourly')">
                        歷史使用
                    </button>
                </div>

                <div *ngIf="activeTab === 'daily'" class="tab-content active">
                    <div class="chart-placeholder">折線圖 - 每日使用次數趨勢</div>
                    <div #chartContainer class="chart-placeholder" style="width:100%; height:400px;"></div>
                    <div class="data-list">
                        <div class="data-item" *ngFor="let item of dailyData">
                            <span>{{ item.login_date }}</span>
                            <strong *ngIf="item.isHighlight; else normalValue">{{ item.login_count }}</strong>
                            <ng-template #normalValue>
                                <span>{{ item.login_count }}</span>
                            </ng-template>
                        </div>
                    </div>
                </div>

                <div *ngIf="activeTab === 'hourly'" class="tab-content active">
                    <!-- <div class="chart-placeholder">
                        長條圖 - 歷時使用趨勢
                    </div> -->
                    <!-- <div #chart class="chart-placeholder" style="width: 100%; height: 400px;"> -->
                        <!-- 這裡會被 ECharts 渲染 -->
                    <!-- </div> -->
                    <!-- <div #chartContainer style="width: 100%; height: 400px;"></div> -->
                    <div #chartContainer class="chart-placeholder" style="width:100%; height:400px;"></div>

                    <!-- <canvas id="myChart"></canvas> -->
                    <!-- <canvas #myChart></canvas> -->
                    <!-- 折線圖 canvas -->
                    <div class="data-list">
                        <div class="data-item" *ngFor="let item of hourlyData">
                            <span>{{ item.login_date.split('T')[0] }}</span>
                            <strong *ngIf="item.isHighlight; else normalValue">{{ item.login_count }}次</strong>
                            <ng-template #normalValue>
                                <span>{{ item.login_count }}</span>
                            </ng-template>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ 分類 -->
            <div class="card" id="card-faq">
                <h3>📂 FAQ 分類管理</h3>
                <table>
                    <thead>
                        <tr>
                            <th>分類名稱</th>
                            <th>問題數</th>
                            <th>使用率</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let category of faqCategories">
                            <td>{{ category.categoryName }}</td>
                            <td>{{ category.itemCount }}</td>
                            <td>
                                <div class="progress-bar">
                                    <div class="progress-fill" [style.width.%]="category.usageRate"></div>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-secondary" (click)="onButtonClick('編輯')">編輯</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 成功率 -->
            <div class="card" id="card-success">
                <h3>🕛回答遇時次數追蹤</h3>
                <div class="chart-placeholder">折線圖 - 遇時次數分析</div>
                <div class="success-rate">
                    <div class="grid-box">
                        <div class="grid-number">94%</div>
                        <div class="grid-label">整體遇時率</div>
                    </div>
                </div>
            </div>

            <!-- 未知問題 -->
            <div class="card" id="card-unknown">
                <h3>❓ 未知問題收集</h3>
                <div class="btn-group">
                    <button class="btn btn-primary" (click)="onButtonClick('匯出清單')">匯出清單</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>問題內容</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let question of unknownQuestions">
                            <td>{{ question.msg }}</td>
                            <td>
                                <button class="btn btn-secondary" (click)="onButtonClick('加入FAQ')">FAQ</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>